<html xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{layout}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<main layout:fragment="content">
  <h3 class="mb-3">문화포털 검색</h3>

  <form class="row g-2 mb-3" method="get" th:action="@{/events/search}">
    <div class="col-auto">
      <label class="form-label">분류(dtype)</label>
      <select class="form-select" name="dtype" th:value="${dtype}">
        <option>전시</option><option>연극</option><option>뮤지컬</option>
        <option>오페라</option><option>음악</option><option>콘서트</option>
        <option>국악</option><option>무용</option><option>기타</option>
      </select>
    </div>
    <div class="col-auto">
      <label class="form-label">제목(2자+)</label>
      <input class="form-control" type="text" name="title" th:value="${title}">
    </div>
    <div class="col-auto">
      <label class="form-label">pageNo</label>
      <input class="form-control" type="number" min="1" name="pageNo">
    </div>
    <div class="col-auto">
      <label class="form-label">numOfRows</label>
      <input class="form-control" type="number" min="1" name="numOfRows" placeholder="10">
    </div>
    <div class="col-auto align-self-end"><button class="btn btn-primary">검색</button></div>
  </form>

  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
    <div class="col" th:each="s : ${stores}">
      <div class="card h-100 shadow-sm">
        <img th:if="${s.imageObject}" th:src="${s.imageObject}" class="card-img-top" alt="thumbnail">
        <div class="card-body">
          <h5 class="card-title" th:text="${s.title}">제목</h5>
          <p class="card-text mb-1"><strong>분야</strong> <span th:text="${s.type}"></span></p>
          <p class="card-text mb-1"><strong>기간</strong> <span th:text="${s.period}"></span></p>
          <p class="card-text mb-1"><strong>시간</strong> <span th:text="${s.eventPeriod}"></span></p>
          <p class="card-text mb-1"><strong>장소</strong> <span th:text="${s.eventSite}"></span></p>
          <p class="card-text mb-1"><strong>금액</strong> <span th:text="${s.charge}"></span></p>
          <a class="btn btn-outline-secondary btn-sm" th:if="${s.url}" th:href="${s.url}" target="_blank">상세보기</a>
        </div>
      </div>
    </div>
  </div>
</main>
<!-- 검색 폼 ... (지금 그대로 유지) -->

<hr/>

<div th:if="${events != null}">
  <p th:if="${#lists.isEmpty(events)}" style="color:#888;">
    검색 결과가 없습니다.
  </p>

  <div th:if="${!#lists.isEmpty(events)}">
    <p>
      총 <strong th:text="${events.size()}">0</strong>건
      <span th:if="${title}"> — 제목: <em th:text="${title}"></em></span>
      <span th:if="${dtype}">, 분류: <em th:text="${dtype}"></em></span>
    </p>

    <table border="1" cellpadding="6" cellspacing="0" style="border-collapse:collapse; width:100%;">
      <thead>
      <tr>
        <th style="width:38%;">제목</th>
        <th style="width:12%;">분야</th>
        <th style="width:18%;">기간</th>
        <th style="width:20%;">장소</th>
        <th style="width:12%;">바로가기</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="e : ${events}">
        <td>
          <div th:text="${e.title}">제목</div>
          <div th:if="${e.description}" style="color:#666; font-size:12px;"
               th:utext="${e.description}">설명</div>
        </td>
        <td th:text="${e.type}">분야</td>
        <td>
          <div th:text="${e.period}">기간</div>
          <div th:if="${e.eventPeriod}" style="color:#666; font-size:12px;"
               th:text="${e.eventPeriod}">시간</div>
        </td>
        <td th:text="${e.eventSite}">장소</td>
        <td>
          <a th:if="${e.url}" th:href="${e.url}" target="_blank" rel="noopener">링크</a>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

</html>
